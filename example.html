<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-12-21 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20141221" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Soabase &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/randgalt/soabase">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Soabase</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-12-21
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.1.0-SNAPSHOT
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Soabase</li>
                              
      <li>
  
                          <a href="index.html" title="About">
          <i class="none"></i>
        About</a>
            </li>
                
      <li>
  
                          <a href="usage.html" title="Usage">
          <i class="none"></i>
        Usage</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Example</a>
          </li>
                              <li class="nav-header">Features</li>
                              
      <li>
  
                          <a href="discovery.html" title="Service Discovery">
          <i class="none"></i>
        Service Discovery</a>
            </li>
                
      <li>
  
                          <a href="client.html" title="REST Client">
          <i class="none"></i>
        REST Client</a>
            </li>
                
      <li>
  
                          <a href="attributes.html" title="Dynamic Attributes">
          <i class="none"></i>
        Dynamic Attributes</a>
            </li>
                
      <li>
  
                          <a href="admin.html" title="Administration">
          <i class="none"></i>
        Administration</a>
            </li>
                
      <li>
  
                          <a href="config.html" title="Configuration">
          <i class="none"></i>
        Configuration</a>
            </li>
                              <li class="nav-header">Details</li>
                              
      <li>
  
                          <a href="source-repository.html" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                
      <li>
  
                          <a href="issue-tracking.html" title="Issues">
          <i class="none"></i>
        Issues</a>
            </li>
                
      <li>
  
                          <a href="apidocs/index.html" title="JavaDoc">
          <i class="none"></i>
        JavaDoc</a>
            </li>
                
      <li>
  
                          <a href="team-list.html" title="Team">
          <i class="none"></i>
        Team</a>
            </li>
                              <li class="nav-header">Reports</li>
                              
      <li>
  
                          <a href="project-summary.html" title="Summary">
          <i class="none"></i>
        Summary</a>
            </li>
                
      <li>
  
                          <a href="dependency-management.html" title="Dependencies">
          <i class="none"></i>
        Dependencies</a>
            </li>
                
      <li>
  
                          <a href="license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                   
        
        
        
    <iframe src="http://www.facebook.com/plugins/like.php?href=https://github.com/randgalt/soabase&send=false&layout=box_count&show-faces=false&action=like&colorscheme=light"
        scrolling="no" frameborder="0"
        style="border:none; width:48px; height:63px; margin-top: 10px;" ></iframe>
               <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2><a name="Example"></a>Example</h2>
<p>The Soabase example shows some of the features of the various bundles and utilities.</p>
<div class="section">
<h3><a name="Building_the_example"></a>Building the example</h3>
<p>The Soabase example is built using Apache Maven. Download the example POM into a new directory and then build it.</p>
<div class="source">
<pre>mkdir soabase
cd soabase
wget https://raw.githubusercontent.com/Randgalt/soabase/master/soabase-example/src/main/resources/pom.xml
mvn clean package</pre></div></div>
<div class="section">
<h3><a name="Running_the_example"></a>Running the example</h3>
<p>The example consists of 4 separate applications:</p>
<ul>
<li>mock-database</li>
<li>mock-zookeeper</li>
<li>goodbye</li>
<li>hello
<p>You will run 1 instance of mock-database and mock-zookeeper. You can run multiple versions of goodbye. For example purposes, run at least 2. Lastly, run one instance of hello.</p>
<p>From the soabase directory (assuming a *nix system):</p>
<div class="source">
<pre># Run the mock database in the background
java -jar ./target/mock-database.jar &amp;

# Run the mock zookeeper in the background
java -jar ./target/mock-zookeeper.jar &amp;

# Run 2 instances of the goodbye app in the background
java -jar ./target/goodbye.jar &amp;
java -jar ./target/goodbye.jar &amp;

# Run the hello app in the background
java -jar ./target/hello.jar &amp;
# You will see output that shows the ports for the hello app - save these</pre></div></li></ul></div>
<div class="section">
<h3><a name="Performing_the_example_tasks"></a>Performing the example tasks</h3>
<ul>
<li>REST client/server and Discovery
<div class="source">
<pre>curl http://localhost:HelloMainPort/hello</pre></div>
<p>This will make an HTTP/REST call to the Hello app. The Hello app will then use Discovery to query a Goodbye app instance. The Hello app will then return the Goodbye app's result plus its own. You will see the Hello app's instance name and service name. You will also see one of the Goodbye app's instance names. If you execute the REST call again you should see a different Goodbye app instance. The default load balancer is round robin so each REST call should cycle through all the Goodbye apps.</p>
<p>This example shows the following features:</p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="center">Discovery Integration</td>
<td align="center">Soabase automatically registers services with the Sobase Discovery system.</td></tr>
<tr class="b">
<td align="center">Integrated REST Client</td>
<td align="center">Soabase wraps both the Apache HTTP Client and the Jersey Client so that they are integrated with Soabase's Discovery system. The URL used is <tt>http://00000.goodbye/goodbye</tt>. Soabase will see the &quot;00000.name&quot; pattern and replace this by looking up the service in the Discovery system. If the call fails, it will get retried via a new lookup from the Discovery system.</td></tr>
<tr class="a">
<td align="center">Request Id</td>
<td align="center">In an SOA system, a single external user request will result in many internal service calls. A method for tying all of them together back to the original request is vital. Sobase adds a Request Id header which the wrapped REST Clients are aware of. In the example you see that the Hello app's REST call tp the Goodbye app maintained the same Request Id.</td></tr></table></li>
<li>Dynamic Attributes
<p>The MockDatabase app sets a few dynamic attributes that you can query for.</p>
<div class="source">
<pre>curl http://localhost:HelloAdminPort/api/soa/attributes/test</pre></div>
<p>This will return &quot;global&quot;.</p>
<div class="source">
<pre>curl http://localhost:GoodbyeAdminPort/api/soa/attributes/test</pre></div>
<p>This will also return &quot;global&quot;.</p>
<div class="source">
<pre>curl http://localhost:HelloAdminPort/api/soa/attributes/test2</pre></div>
<p>This will return &quot;one&quot;.</p>
<div class="source">
<pre>curl http://localhost:GoodbyeAdminPort/api/soa/attributes/test2</pre></div>
<p>This will return &quot;two&quot;.</p>
<div class="source">
<pre>curl -X PUT -d '&quot;new&quot;' -H &quot;Content-Type: application/json&quot; http://localhost:HelloAdminPort/api/soa/attributes/test
curl http://localhost:HelloAdminPort/api/soa/attributes/test</pre></div>
<p>This will return &quot;new&quot;.</p>
<div class="source">
<pre>curl http://localhost:GoodbyeAdminPort/api/soa/attributes/test</pre></div>
<p>This will still return &quot;global&quot;.</p>
<div class="source">
<pre>curl -X DELETE http://localhost:HelloAdminPort/api/soa/attributes/test
curl http://localhost:HelloAdminPort/api/soa/attributes/test</pre></div>
<p>This will return &quot;global&quot; again.</p>
<p>This example shows the following features:</p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="center">Scoped Attributes</td>
<td align="center">Soabase dynamic attributes can be scoped. There are three default scopes: Global, service and instance. You can also define your own scopes. In the example, the attribute &quot;test&quot; is set at the global scope so is the same for both Goodbye and Hello apps. The attribute &quot;test2&quot; is set differently for the service scope and so Goodbye and Hello return different values.</td></tr>
<tr class="b">
<td align="center">Jersey for Admin</td>
<td align="center">Soabase adds Jersey support to Dropwizard's admin port. Soabase defines a few APIs and you can add your own.</td></tr>
<tr class="a">
<td align="center">Local Overrides</td>
<td align="center">Through the admin API you can set instance specific overrides for dynamic attributes.</td></tr></table></li></ul></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2014
                        <a href="http://soabase.github.io/">Soabase</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
